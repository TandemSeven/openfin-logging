"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const redux_openfin_1 = require("redux-openfin");
const channel_1 = require("redux-openfin/channel");
const init_1 = require("./init");
const makeType_1 = require("./utils/makeType");
const GlobalTypes_1 = require("./GlobalTypes");
function middlewareCreator() {
    return ((store) => {
        if (store && !init_1.default.clientReduxDispatch) {
            // console.log(`[react-openfin] middleware init clientReduxDispatch`);
            init_1.default.clientReduxDispatch = store.dispatch;
        }
        return (next) => (action) => {
            // console.log(`[react-openfin] middleware 0# ${action.type}`, action);
            // client actions
            if ((!action[channel_1.SHARED_ACTION_ORIGIN_TAG]) && (redux_openfin_1.isReqAct(action.type) ||
                makeType_1.isReqAct(action.type))) {
                if (window[GlobalTypes_1.REACT_OPENFIN_DISPATCH_FIELD_NAME]) {
                    // console.log(`[react-openfin] middleware 1# ${action.type}`, action);
                    window[GlobalTypes_1.REACT_OPENFIN_DISPATCH_FIELD_NAME](action);
                }
            }
            else if ((!action[channel_1.SHARED_ACTION_ORIGIN_TAG]) &&
                window[GlobalTypes_1.REACT_OPENFIN_DISPATCH_FIELD_NAME] &&
                init_1.default.sharedActionsDict.has(action.type)) {
                // console.log(`[react-openfin] middleware 2# ${action.type}`, action);
                window[GlobalTypes_1.REACT_OPENFIN_DISPATCH_FIELD_NAME](action);
                return next(action);
            }
            else {
                return next(action);
            }
        };
    });
}
exports.default = middlewareCreator;
//# sourceMappingURL=ReactOpenfinMiddleware.js.map